<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arabian Talent League - GODSPEED</title>
    <script src="https://cdn.tailwindcss.com"></script>
   
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
   
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
   
    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
   
    <!-- jsPDF for Receipt -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
   
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&family=Sora:wght@300;400;500;600;700;800&family=DM+Serif+Display:ital@0;1&display=swap');
       
        /* Updated Color Variables - Using #f6cc68 as primary */
        :root {
            --white: #FFFFFF;
            --primary: #f6cc68;
            --primary-dark: #d4a84a;
            --primary-light: rgba(246, 204, 104, 0.15);
            --deep-black: #010000;
            --charcoal: #1a1a1a;
            --primary-glow: rgba(246, 204, 104, 0.4);
            --gradient-1: linear-gradient(135deg, #f6cc68 0%, #d4a84a 50%, #f6cc68 100%);
            --gradient-2: linear-gradient(180deg, #010000 0%, #f6cc68 100%);
            --gradient-3: linear-gradient(45deg, #f6cc68, #d4a84a);
        }
       
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: var(--deep-black);
            min-height: 100vh;
            font-family: 'Outfit', sans-serif;
            overflow-x: hidden;
            color: var(--white);
        }

        /* ==================== BACKGROUND EFFECTS ==================== */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background:
                radial-gradient(ellipse at 0% 0%, rgba(246, 204, 104, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 100% 100%, rgba(246, 204, 104, 0.05) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(246, 204, 104, 0.03) 0%, transparent 70%),
                var(--deep-black);
        }

        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-image:
                linear-gradient(rgba(246, 204, 104, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(246, 204, 104, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
        }

        .floating-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: floatOrb 20s ease-in-out infinite;
            pointer-events: none;
            z-index: -1;
        }

        .orb-1 {
            width: 400px;
            height: 400px;
            background: var(--primary);
            top: -100px;
            right: -100px;
            animation-delay: 0s;
        }

        .orb-2 {
            width: 300px;
            height: 300px;
            background: var(--primary-dark);
            bottom: -50px;
            left: -50px;
            animation-delay: -5s;
        }

        .orb-3 {
            width: 200px;
            height: 200px;
            background: var(--primary);
            top: 50%;
            left: 50%;
            animation-delay: -10s;
        }

        @keyframes floatOrb {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(30px, -30px) scale(1.1); }
            50% { transform: translate(-20px, 20px) scale(0.9); }
            75% { transform: translate(20px, 30px) scale(1.05); }
        }

        /* ==================== TYPOGRAPHY ==================== */
        .font-display {
            font-family: 'DM Serif Display', serif;
        }

        .font-heading {
            font-family: 'Space Grotesk', sans-serif;
        }

        .font-body {
            font-family: 'Sora', sans-serif;
        }

        .text-gradient {
            background: var(--gradient-3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .text-primary {
            color: var(--primary);
        }

        /* ==================== NAVIGATION ==================== */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 1rem 2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .navbar.scrolled {
            background: rgba(1, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(246, 204, 104, 0.2);
            padding: 0.75rem 2rem;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-group {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'DM Serif Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--deep-black);
            box-shadow: 0 4px 20px rgba(246, 204, 104, 0.3);
        }

        .logo-text {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
            letter-spacing: -0.5px;
        }

        .logo-subtitle {
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.7;
            margin-top: -2px;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* ==================== BUTTONS ==================== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.75rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 0.3px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: var(--gradient-3);
            color: var(--deep-black);
            box-shadow: 0 4px 20px rgba(246, 204, 104, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(246, 204, 104, 0.4);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-secondary {
            background: transparent;
            color: var(--white);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary-light);
            border-color: var(--primary);
        }

        .btn-ghost {
            background: rgba(246, 204, 104, 0.1);
            color: var(--primary);
            border: 1px solid rgba(246, 204, 104, 0.3);
        }

        .btn-ghost:hover {
            background: rgba(246, 204, 104, 0.2);
        }

        .btn-lg {
            padding: 1.25rem 2.5rem;
            font-size: 1.1rem;
            border-radius: 16px;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* ==================== HERO SECTION ==================== */
        .hero-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 120px 2rem 60px;
            position: relative;
        }

        .hero-container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
        }

        .hero-content {
            z-index: 10;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--primary-light);
            border: 1px solid rgba(246, 204, 104, 0.3);
            border-radius: 100px;
            font-size: 0.85rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        .hero-badge-dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .hero-title {
            font-family: 'DM Serif Display', serif;
            font-size: clamp(3rem, 6vw, 5rem);
            line-height: 1.1;
            margin-bottom: 1.5rem;
        }

        .hero-title-line {
            display: block;
        }

        .hero-title-accent {
            color: var(--primary);
            font-style: italic;
        }

        .hero-description {
            font-family: 'Sora', sans-serif;
            font-size: 1.15rem;
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 2.5rem;
            max-width: 500px;
        }

        .hero-cta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .hero-stats {
            display: flex;
            gap: 3rem;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(246, 204, 104, 0.2);
        }

        .stat-item {
            text-align: left;
        }

        .stat-number {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 0.25rem;
        }

        /* Hero Visual */
        .hero-visual {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .hero-card-stack {
            position: relative;
            width: 100%;
            max-width: 450px;
            aspect-ratio: 4/5;
        }

        .hero-card {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 24px;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid rgba(246, 204, 104, 0.2);
        }

        .hero-card:nth-child(1) {
            z-index: 3;
            transform: rotate(-3deg);
        }

        .hero-card:nth-child(2) {
            z-index: 2;
            transform: rotate(3deg) translateX(20px) translateY(-10px);
            opacity: 0.8;
        }

        .hero-card:nth-child(3) {
            z-index: 1;
            transform: rotate(-6deg) translateX(-20px) translateY(-20px);
            opacity: 0.6;
        }

        .hero-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .hero-card-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            background: linear-gradient(transparent, rgba(1, 0, 0, 0.9));
        }

        .hero-card-tag {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: var(--primary);
            color: var(--deep-black);
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .hero-card-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* ==================== SPONSORS SECTION ==================== */
        .sponsors-section {
            padding: 60px 2rem;
            background: rgba(26, 26, 26, 0.5);
            border-top: 1px solid rgba(246, 204, 104, 0.1);
            border-bottom: 1px solid rgba(246, 204, 104, 0.1);
        }

        .sponsors-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .sponsors-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .sponsors-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .sponsors-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .sponsors-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4rem;
            flex-wrap: wrap;
        }

        .sponsor-item {
            padding: 1.5rem 2.5rem;
            background: rgba(246, 204, 104, 0.05);
            border: 1px solid rgba(246, 204, 104, 0.15);
            border-radius: 16px;
            transition: all 0.3s;
            text-align: center;
        }

        .sponsor-item:hover {
            background: rgba(246, 204, 104, 0.1);
            transform: translateY(-3px);
            border-color: var(--primary);
        }

        .sponsor-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--white);
            margin-bottom: 0.25rem;
        }

        .sponsor-type {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--primary);
        }

        /* ==================== FEATURES SECTION ==================== */
        .features-section {
            padding: 100px 2rem;
        }

        .features-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--primary);
            margin-bottom: 1rem;
            display: block;
        }

        .section-title {
            font-family: 'DM Serif Display', serif;
            font-size: clamp(2rem, 4vw, 3rem);
            margin-bottom: 1rem;
        }

        .section-description {
            font-family: 'Sora', sans-serif;
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.6);
            max-width: 600px;
            margin: 0 auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .feature-card {
            background: rgba(26, 26, 26, 0.6);
            border: 1px solid rgba(246, 204, 104, 0.15);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-3);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .feature-card:hover {
            background: rgba(26, 26, 26, 0.8);
            border-color: rgba(246, 204, 104, 0.3);
            transform: translateY(-5px);
        }

        .feature-card:hover::before {
            opacity: 1;
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: var(--primary-light);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            margin-bottom: 1.5rem;
        }

        .feature-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--primary);
        }

        .feature-description {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.6);
            line-height: 1.7;
        }

        /* ==================== GALLERY SECTION ==================== */
        .gallery-section {
            padding: 80px 2rem;
            background:
                radial-gradient(ellipse at 0% 0%, rgba(246, 204, 104, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 100% 100%, rgba(246, 204, 104, 0.05) 0%, transparent 50%),
                var(--deep-black);
        }

        .gallery-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
        }

        .gallery-item {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s;
            border: 2px solid transparent;
        }

        .gallery-item:hover {
            border-color: var(--primary);
        }

        .gallery-item:nth-child(1) {
            grid-column: span 2;
            grid-row: span 2;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        .gallery-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(transparent, rgba(1, 0, 0, 0.8));
            opacity: 0;
            transition: opacity 0.3s;
            display: flex;
            align-items: flex-end;
            padding: 1.5rem;
        }

        .gallery-item:hover .gallery-overlay {
            opacity: 1;
        }

        .gallery-label {
            font-weight: 600;
            font-size: 1rem;
            color: var(--primary);
        }

        /* ==================== APPLICATION FORM ==================== */
        .form-section {
            padding: 100px 2rem;
        }

        .form-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .form-card {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(246, 204, 104, 0.2);
            border-radius: 24px;
            padding: 3rem;
            backdrop-filter: blur(20px);
        }

        .form-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .form-title {
            font-family: 'DM Serif Display', serif;
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            color: var(--primary);
        }

        .form-subtitle {
            color: rgba(255, 255, 255, 0.6);
            font-size: 1rem;
        }

        .form-grid {
            display: grid;
            gap: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .form-group {
            position: relative;
        }

        .form-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 1rem 1.25rem;
            background: rgba(1, 0, 0, 0.6);
            border: 2px solid rgba(246, 204, 104, 0.2);
            border-radius: 12px;
            color: var(--white);
            font-family: 'Outfit', sans-serif;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(1, 0, 0, 0.8);
            box-shadow: 0 0 0 4px rgba(246, 204, 104, 0.1);
        }

        .form-input[readonly] {
            opacity: 0.7;
            cursor: not-allowed;
        }

        textarea.form-input {
            min-height: 150px;
            resize: vertical;
        }

        .form-helper {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 0.5rem;
        }

        .char-counter {
            text-align: right;
            font-size: 0.8rem;
            color: var(--primary);
            margin-top: 0.5rem;
        }

        /* Phone Input with Country Code */
        .phone-input-group {
            display: flex;
            gap: 0.5rem;
        }

        .country-code-select {
            width: 130px;
            flex-shrink: 0;
        }

        .phone-number-input {
            flex: 1;
        }

        /* Talent Category Select */
        .talent-category-select {
            position: relative;
        }

        .talent-category-select select {
            appearance: none;
            cursor: pointer;
            padding-right: 2.5rem;
        }

        .talent-category-select::after {
            content: '‚ñº';
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            pointer-events: none;
            font-size: 0.8rem;
        }

        /* Sub-category checkbox grid */
        .subcategory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(1, 0, 0, 0.4);
            border-radius: 12px;
            border: 1px solid rgba(246, 204, 104, 0.1);
        }

        .subcategory-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .subcategory-item:hover {
            background: rgba(246, 204, 104, 0.1);
        }

        .subcategory-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        /* File Upload */
        .file-upload-area {
            border: 2px dashed rgba(246, 204, 104, 0.3);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background: rgba(246, 204, 104, 0.05);
        }

        .file-upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .file-upload-text {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .file-upload-hint {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .file-input {
            display: none;
        }

        .file-list {
            margin-top: 1rem;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background: rgba(246, 204, 104, 0.1);
            border-radius: 10px;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            border: 1px solid rgba(246, 204, 104, 0.2);
        }

        .file-item-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .file-item-size {
            color: var(--primary);
            font-size: 0.8rem;
        }

        .file-remove-btn {
            background: rgba(239, 68, 68, 0.2);
            border: none;
            color: #F87171;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .file-remove-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Payment Section */
        .payment-card {
            background: linear-gradient(135deg, rgba(246, 204, 104, 0.15), rgba(246, 204, 104, 0.05));
            border: 1px solid rgba(246, 204, 104, 0.3);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }

        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .payment-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .payment-amount {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .payment-currency {
            font-size: 1rem;
            opacity: 0.7;
        }

        .payment-features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .payment-feature {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .payment-check {
            color: var(--primary);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .form-actions .btn {
            flex: 1;
        }

        /* Age Display */
        .age-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--primary-light);
            border: 1px solid rgba(246, 204, 104, 0.3);
            border-radius: 8px;
            margin-top: 0.5rem;
        }

        .age-value {
            font-weight: 600;
            color: var(--primary);
        }

        .category-badge {
            background: var(--gradient-3);
            color: var(--deep-black);
            padding: 0.25rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .age-warning {
            background: rgba(220, 38, 38, 0.1);
            border: 1px solid rgba(220, 38, 38, 0.3);
            color: #FCA5A5;
            padding: 1rem;
            border-radius: 12px;
            margin-top: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        /* ==================== ADMIN DASHBOARD ==================== */
        .admin-section {
            min-height: 100vh;
        }

        .admin-header {
            background: rgba(26, 26, 26, 0.95);
            border-bottom: 1px solid rgba(246, 204, 104, 0.2);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
        }

        .admin-nav {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(246, 204, 104, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .stat-card:hover {
            border-color: rgba(246, 204, 104, 0.4);
            transform: translateY(-2px);
        }

        .stat-card-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 0.5rem;
        }

        .stat-card-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Data Table */
        .data-table-container {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(246, 204, 104, 0.2);
            border-radius: 20px;
            overflow: auto;
            max-height: 70vh;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: rgba(246, 204, 104, 0.1);
            padding: 1rem;
            text-align: left;
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--primary);
            border-bottom: 1px solid rgba(246, 204, 104, 0.2);
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(246, 204, 104, 0.1);
            font-size: 0.9rem;
        }

        .data-table tr:hover {
            background: rgba(246, 204, 104, 0.05);
        }

        .user-cell {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid rgba(246, 204, 104, 0.3);
        }

        .user-avatar-placeholder {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--gradient-3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1rem;
            color: var(--deep-black);
        }

        .user-info-name {
            font-weight: 600;
        }

        .user-info-email {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.35rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-pending {
            background: rgba(246, 204, 104, 0.2);
            color: var(--primary);
        }

        .status-approved {
            background: rgba(34, 197, 94, 0.2);
            color: #4ADE80;
        }

        .status-rejected {
            background: rgba(239, 68, 68, 0.2);
            color: #F87171;
        }

        .action-btns {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .action-btn-approve {
            background: rgba(34, 197, 94, 0.2);
            color: #4ADE80;
        }

        .action-btn-reject {
            background: rgba(239, 68, 68, 0.2);
            color: #F87171;
        }

        .action-btn-view {
            background: rgba(59, 130, 246, 0.2);
            color: #60A5FA;
        }

        /* ==================== MODALS ==================== */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(1, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 2rem;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--charcoal);
            border: 1px solid rgba(246, 204, 104, 0.3);
            border-radius: 24px;
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid rgba(246, 204, 104, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(246, 204, 104, 0.1);
            border: none;
            color: var(--white);
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #F87171;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid rgba(246, 204, 104, 0.2);
            display: flex;
            gap: 1rem;
        }

        /* Success Modal */
        .success-icon {
            width: 80px;
            height: 80px;
            background: rgba(34, 197, 94, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2.5rem;
        }

        .success-title {
            font-family: 'DM Serif Display', serif;
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #4ADE80;
            text-align: center;
        }

        .success-message {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 1.5rem;
            line-height: 1.6;
            text-align: center;
        }

        .success-details {
            background: rgba(1, 0, 0, 0.5);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .success-detail-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(246, 204, 104, 0.1);
        }

        .success-detail-row:last-child {
            border-bottom: none;
        }

        .success-detail-label {
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
        }

        .success-detail-value {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.9rem;
        }

        /* File Viewer Modal */
        .file-viewer-container {
            background: rgba(1, 0, 0, 0.5);
            border-radius: 16px;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .file-viewer-container img,
        .file-viewer-container video {
            max-width: 100%;
            max-height: 500px;
            border-radius: 12px;
        }

        /* User Profile Button */
        .user-profile-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: rgba(246, 204, 104, 0.1);
            border: 1px solid rgba(246, 204, 104, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-profile-btn:hover {
            background: rgba(246, 204, 104, 0.2);
        }

        .user-profile-avatar {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            object-fit: cover;
        }

        .user-profile-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ==================== FOOTER ==================== */
        .footer {
            background: rgba(1, 0, 0, 0.95);
            border-top: 1px solid rgba(246, 204, 104, 0.2);
            padding: 60px 2rem 30px;
        }

        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-brand {
            max-width: 300px;
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .footer-logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'DM Serif Display', serif;
            font-size: 1.25rem;
            color: var(--deep-black);
        }

        .footer-logo-text {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            font-size: 1.25rem;
        }

        .footer-description {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            line-height: 1.7;
        }

        .footer-heading {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 1.25rem;
            color: var(--primary);
        }

        .footer-links {
            list-style: none;
        }

        .footer-link {
            margin-bottom: 0.75rem;
        }

        .footer-link a {
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }

        .footer-link a:hover {
            color: var(--primary);
        }

        .footer-bottom {
            padding-top: 2rem;
            border-top: 1px solid rgba(246, 204, 104, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 1024px) {
            .hero-container {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .hero-description {
                margin: 0 auto 2.5rem;
            }

            .hero-cta {
                justify-content: center;
            }

            .hero-stats {
                justify-content: center;
            }

            .hero-visual {
                display: none;
            }

            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .footer-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 1rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .phone-input-group {
                flex-direction: column;
            }

            .country-code-select {
                width: 100%;
            }

            .form-card {
                padding: 1.5rem;
            }

            .gallery-grid {
                grid-template-columns: 1fr;
            }

            .gallery-item:nth-child(1) {
                grid-column: span 1;
                grid-row: span 1;
            }

            .footer-grid {
                grid-template-columns: 1fr;
            }

            .footer-bottom {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .admin-stats {
                grid-template-columns: 1fr 1fr;
            }

            .data-table-container {
                overflow-x: auto;
            }

            .data-table {
                min-width: 1200px;
            }

            .subcategory-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ==================== SCROLLBAR ==================== */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--deep-black);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* ==================== UTILITIES ==================== */
        .hidden {
            display: none !important;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="bg-pattern"></div>
    <div class="grid-overlay"></div>
    <div class="floating-orb orb-1"></div>
    <div class="floating-orb orb-2"></div>
    <div class="floating-orb orb-3"></div>
        <!-- ==================== PUBLIC PAGE ==================== -->
    <div id="publicPage">
        <!-- Navigation -->
        <nav class="navbar" id="navbar">
            <div class="nav-container">
                <div class="logo-group">
                    <div class="logo-icon"><img src="Arabian Talent League .jpg"></div>
                    <div>
                        <div class="logo-text">Arabian Talent League</div>
                        <div class="logo-subtitle"></div>
                    </div>
                </div>
                <div class="nav-actions" id="navActions">
                    <button onclick="handleAuthButton()" class="btn btn-secondary" id="authBtn">
                        Sign In
                    </button>
                    <button onclick="showAdminLogin()" class="btn btn-ghost">
                        Admin
                    </button>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-container">
                <div class="hero-content">
                    <div class="hero-badge">
                        <span class="hero-badge-dot"></span>
                        <span>Arabian Talent League - Applications Opening Soon</span>
                    </div>
                    <h1 class="hero-title">
                        <span class="hero-title-line">Arabian</span>
                        <span class="hero-title-line hero-title-accent">Talent League</span>
                        <span class="hero-title-line"></span>
                    </h1>
                    <p class="hero-description">
                        Join the most prestigious talent competition in the UAE.
                        Whether you sing, dance, perform, or create - this is your stage to shine.
                        All nationalities welcome!
                    </p>
                    <div class="hero-cta">
                        <button onclick="handleApplyNow()" class="btn btn-primary btn-lg">
                            Applications opening soon
                        </button>
                       
                        <button onclick="showSponsorModal()" class="btn btn-secondary btn-lg">
        To Be a Sponsor Click Here
    </button>
                    </div>
                   
                </div>
                <div class="hero-visual">
                    <div class="hero-card-stack">
                        <div class="hero-card">
                            <img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=500&h=600&fit=crop" alt="Performance">
                            <div class="hero-card-overlay">
                                <span class="hero-card-tag">üé§ Performing Arts</span>
                                <div class="hero-card-title">Show Your Talent</div>
                            </div>
                        </div>
                        <div class="hero-card">
                            <img src="https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?w=500&h=600&fit=crop" alt="Dance">
                        </div>
                        <div class="hero-card">
                            <img src="https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=500&h=600&fit=crop" alt="Music">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Sponsors Section -->
        <section class="sponsors-section">
            <div class="sponsors-container">
                <div class="sponsors-header">
                    <div class="sponsors-label">Proudly Supported By</div>
                    <h2 class="sponsors-title">Our Partners</h2>
                </div>
                <div class="sponsors-grid">
                    <div class="sponsor-item">
                        <div class="sponsor-name">Managed and Organized By</div>
                        <img src="godspeed.jpg" style="height:120px; width:120px; object-fit:contain; display:block; margin:0 auto;">
                        <div class="sponsor-type">Godspeed Events & Entertainment</div>
                    </div>
                    <div class="sponsor-item">
                        <div class="sponsor-name">Conceptualized By</div>
                       <img src="singhulars logo.jpeg" style="height:120px; width:120px; object-fit:contain; display:block; margin:0 auto;">
                        <div class="sponsor-type">Singhulars</div>
                    </div>
                    <div class="sponsor-item">
                        <div class="sponsor-name">Technology Partner</div>
                        <img src="devnity.jpg" style="height:120px; width:120px; object-fit:contain; display:block; margin:0 auto;">
                        <div class="sponsor-type">Devnity co</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section">
            <div class="features-container">
                <div class="section-header">
                    <span class="section-label">Why Join Us</span>
                    <h2 class="section-title">Experience Excellence</h2>
                    <p class="section-description">
                        More than just a competition - it's a journey towards stardom
                    </p>
                </div>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üèÜ</div>
                        <h3 class="feature-title">National Recognition</h3>
                        <p class="feature-description">
                            Compete at the highest level and gain recognition across the UAE with our prestigious platform.
                        </p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üí∞</div>
                        <h3 class="feature-title">Amazing Prizes</h3>
                        <p class="feature-description">
                            Win substantial cash prizes and exclusive opportunities to kickstart your career.
                        </p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üë®‚Äç‚öñÔ∏è</div>
                        <h3 class="feature-title">Expert Judges</h3>
                        <p class="feature-description">
                            Get evaluated by industry professionals who can provide valuable feedback and connections.
                        </p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üöÄ</div>
                        <h3 class="feature-title">Career Launch</h3>
                        <p class="feature-description">
                            Use our platform as a springboard to launch your professional career in entertainment.
                        </p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üì∫</div>
                        <h3 class="feature-title">Media Exposure</h3>
                        <p class="feature-description">
                            Get featured on major media platforms and social channels reaching millions.
                        </p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üåç</div>
                        <h3 class="feature-title">All Nationalities</h3>
                        <p class="feature-description">
                            Open to all cultures and nationalities residing in UAE. Celebrate diversity through talent!
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery Section -->
        <section class="gallery-section">
            <div class="gallery-container">
                <div class="section-header">
                    <span class="section-label">Past Events</span>
                    <h2 class="section-title">Moments of Glory</h2>
                </div>
                <div class="gallery-grid">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1501281668745-f7f57925c3b4?w=800&h=800&fit=crop" alt="Event 1">
                        <div class="gallery-overlay">
                            <span class="gallery-label">Grand Finale 2023</span>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?w=400&h=400&fit=crop" alt="Event 2">
                        <div class="gallery-overlay">
                            <span class="gallery-label">Live Performance</span>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1478147427282-58a87a120781?w=400&h=400&fit=crop" alt="Event 3">
                        <div class="gallery-overlay">
                            <span class="gallery-label">Dance Round</span>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1514320291840-2e0a9bf2a9ae?w=400&h=400&fit=crop" alt="Event 4">
                        <div class="gallery-overlay">
                            <span class="gallery-label">Music Session</span>
                        </div>
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1429962714451-bb934ecdc4ec?w=400&h=400&fit=crop" alt="Event 5">
                        <div class="gallery-overlay">
                            <span class="gallery-label">Cultural Night</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Application Form Section -->
        <section class="form-section hidden" id="applicationSection">
            <div class="form-container">
                <div class="form-card">
                    <div class="form-header">
                        <h2 class="form-title">üá¶üá™ Application Form</h2>
                        <p class="form-subtitle">Fill in your details to participate in Arabian Talent League</p>
                    </div>
                    <form id="talentForm" class="form-grid">
                        <!-- Row 1: Name & Email -->
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Full Name *</label>
                                <input type="text" id="fullName" required class="form-input" placeholder="Enter your full name">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email Address *</label>
                                <input type="email" id="email" required readonly class="form-input" placeholder="Your email">
                            </div>
                        </div>
                       
                        <!-- Row 2: Mobile with Country Code & DOB -->
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Mobile Number *</label>
                                <div class="phone-input-group">
                                    <select id="countryCode" class="form-select country-code-select" required>
                                        <option value="+971">üá¶üá™ +971 (UAE)</option>
                                        <option value="+91">üáÆüá≥ +91 (India)</option>
                                    </select>
                                    <input type="tel" id="mobile" required pattern="[0-9]{7,10}" class="form-input phone-number-input" placeholder="Mobile number">
                                </div>
                                <p class="form-helper">Enter number without country code</p>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Date of Birth *</label>
                                <input type="date" id="dateOfBirth" required onchange="calculateAge()" class="form-input">
                                <div id="ageDisplay"></div>
                            </div>
                        </div>

                        <!-- Talent Category Selection -->
                        <div class="form-group">
                            <label class="form-label">Select Talent Category *</label>
                            <div class="talent-category-select">
                                <select id="talentCategory" required class="form-select" onchange="showSubcategories()">
                                    <option value="">-- Select a Category --</option>
                                    <option value="performing_arts">üé§ Performing Arts</option>
                                    <option value="cultural_traditional">üåç Cultural & Traditional Arts</option>
                                    <option value="novelty_acts">üé© Novelty Acts</option>
                                    <option value="circus_physical">üé™ Circus, Physical & Fitness Skills</option>
                                    <option value="visual_creative">üé® Visual & Creative Arts</option>
                                    <option value="comedy_voice">üòÇ Comedy, Story & Voice Arts</option>
                                    <option value="special_unique">‚≠ê Special & Unique Skills</option>
                                    <option value="group_community">üë• Group & Community Talent</option>
                                </select>
                            </div>
                        </div>

                        <!-- Subcategories Container -->
                        <div class="form-group" id="subcategoriesContainer" style="display: none;">
                            <label class="form-label">Select Specific Talent(s) *</label>
                            <div class="subcategory-grid" id="subcategoryGrid">
                                <!-- Subcategories will be populated dynamically -->
                            </div>
                        </div>

                        <!-- Talent Description -->
                        <div class="form-group">
                            <label class="form-label">Tell us about your talent (Max 1000 words) *</label>
                            <textarea id="talentDescription" required maxlength="7000" class="form-input" placeholder="Describe your talent in detail... What makes you unique? What's your experience? What will you perform?"></textarea>
                            <div class="char-counter">
                                <span id="charCount">0</span> / 7000 characters
                            </div>
                        </div>

                        <!-- Performance Link (Optional) -->
                        <div class="form-group">
                            <label class="form-label">Performance Video Link (Optional)</label>
                            <input type="url" id="performanceLink" class="form-input" placeholder="YouTube, Instagram, or any video link">
                            <p class="form-helper">Share a link to your previous performance if available</p>
                        </div>

                        <!-- File Upload -->
                        <div class="form-group">
                            <label class="form-label">Upload Performance Files (Max 50MB each) *</label>
                            <div class="file-upload-area" onclick="document.getElementById('fileUpload').click()">
                                <div class="file-upload-icon">üìÅ</div>
                                <div class="file-upload-text">Click to upload or drag and drop</div>
                                <div class="file-upload-hint">MP4, Images, PDF, MP3 ‚Ä¢ Max 50MB per file ‚Ä¢ Max 5 files</div>
                            </div>
                            <input type="file" id="fileUpload" required accept=".mp4,.mov,.avi,image/*,.pdf,.mp3,.wav" multiple class="file-input">
                            <div id="filesList" class="file-list"></div>
                            <p id="fileSize" class="form-helper"></p>
                        </div>

                        <!-- Payment Section -->
                        <div class="payment-card">
                            <div class="payment-header">
                                <div class="payment-title">üí≥ Registration Fee</div>
                                <div class="payment-amount">
                                    <span class="payment-currency">AED</span> 55
                                </div>
                            </div>
                            <div class="payment-features">
                                <div class="payment-feature">
                                    <span class="payment-check">‚úì</span> Application processing
                                </div>
                                <div class="payment-feature">
                                    <span class="payment-check">‚úì</span> Secure payment
                                </div>
                                <div class="payment-feature">
                                    <span class="payment-check">‚úì</span> Powered by Stripe
                                </div>
                                <div class="payment-feature">
                                    <span class="payment-check">‚úì</span> Instant confirmation
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="submit" id="submitBtn" class="btn btn-primary btn-lg">
                                üí≥ Pay AED 55 & Submit
                            </button>
                            <button type="button" onclick="hideApplicationForm()" class="btn btn-secondary btn-lg">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-container">
                <div class="footer-grid">
                    <div class="footer-brand">
                        <div class="footer-logo">
                            <div class="footer-logo-icon"><img src="Arabian Talent League .jpg"></div>
                            <div class="footer-logo-text">Arabian Talent League</div>
                        </div>
                        <p class="footer-description">
                            Arabian Talent League celebrates every community, nationality, and creative expression.
                            All talents based in the UAE are welcome to participate.
                        </p>
                    </div>
                    <div>
                        <h4 class="footer-heading">Quick Links</h4>
                        <ul class="footer-links">
                            <li class="footer-link"><a href="#">Home</a></li>
                            <li class="footer-link"><a href="#">About</a></li>
                            <li class="footer-link"><a href="#">Apply Now</a></li>
                            <li class="footer-link"><a href="#">Contact</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="footer-heading">Categories</h4>
                        <ul class="footer-links">
                            <li class="footer-link"><a href="#">Young Icons (10-20)</a></li>
                            <li class="footer-link"><a href="#">Urban Millennial (21-40)</a></li>
                            <li class="footer-link"><a href="#">Legacy Builders (41-60)</a></li>
                            <li class="footer-link"><a href="#">Timeless Legends (60+)</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="footer-heading">Contact</h4>
                        <ul class="footer-links">
                            <li class="footer-link"><a href="mailto:singhularsgottalent@gmail.com">Email Us</a></li>
                            <li class="footer-link"><a href="#">Support</a></li>
                            <li class="footer-link"><a href="#">FAQ</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-bottom">
                    <div>¬© 2024 Arabian Talent League - Singhulars. All rights reserved.</div>
                    <div>Powered by GODSPEED</div>
                </div>
            </div>
        </footer>
    </div>

    <!-- ==================== USER LOGIN PAGE ==================== -->
    <div id="userLoginPage" class="hidden" style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 2rem;">
        <div class="form-card" style="max-width: 450px; width: 100%;">
            <div class="form-header">
                <div class="logo-icon" style="margin: 0 auto 1rem; width: 60px; height: 60px; font-size: 1.75rem;"><img src="Arabian Talent League .jpg"></div>
                <h2 class="form-title">Welcome Back</h2>
                <p class="form-subtitle">Sign in to continue to Arabian Talent League</p>
            </div>

            <div id="googleSignInButton" style="display: flex; justify-content: center; margin-bottom: 1.5rem;"></div>

            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                <div style="flex: 1; height: 1px; background: rgba(246, 204, 104, 0.3);"></div>
                <span style="font-size: 0.85rem; color: rgba(255,255,255,0.5);">OR</span>
                <div style="flex: 1; height: 1px; background: rgba(246, 204, 104, 0.3);"></div>
            </div>

            <div id="loginForm" class="form-grid">
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password">
                </div>
                <button type="button" onclick="loginUser()" class="btn btn-primary" style="width: 100%;">Sign In</button>
                <p style="text-align: center; font-size: 0.9rem; margin-top: 1rem;">
                    Don't have an account?
                    <button onclick="toggleToRegister()" style="color: var(--primary); background: none; border: none; cursor: pointer; font-weight: 600;">Register</button>
                </p>
            </div>

            <div id="registerForm" class="hidden form-grid">
                <div class="form-group">
                    <label class="form-label">Full Name</label>
                    <input type="text" id="registerName" class="form-input" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="registerEmail" class="form-input" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="registerPassword" class="form-input" placeholder="Create a password (min 6 chars)">
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" id="registerConfirmPassword" class="form-input" placeholder="Confirm your password">
                </div>
                <button type="button" onclick="registerUser()" class="btn btn-primary" style="width: 100%;">Create Account</button>
                <p style="text-align: center; font-size: 0.9rem; margin-top: 1rem;">
                    Already have an account?
                    <button onclick="toggleToLogin()" style="color: var(--primary); background: none; border: none; cursor: pointer; font-weight: 600;">Sign In</button>
                </p>
            </div>

            <button onclick="backToPublicPage()" class="btn btn-ghost" style="width: 100%; margin-top: 1rem;">
                ‚Üê Back to Home
            </button>
        </div>
    </div>

    <!-- ==================== ADMIN DASHBOARD ==================== -->
    <div id="adminDashboard" class="hidden admin-section">
        <header class="admin-header">
            <div class="admin-nav">
                <div class="logo-group">
                    <div class="logo-icon"><img src="Arabian Talent League .jpg"></div>
                    <div>
                        <div class="logo-text">ADMIN PANEL</div>
                        <div class="logo-subtitle">Arabian Talent League</div>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="refreshApplications()" class="btn btn-ghost">üîÑ Refresh</button>
                    <button onclick="exportToCSV()" class="btn btn-ghost">üì• Export CSV</button>
                    <button onclick="logout()" class="btn" style="background: rgba(239, 68, 68, 0.2); color: #F87171;">
                        Logout
                    </button>
                </div>
            </div>
        </header>

        <div class="admin-content">
            <div class="admin-stats">
                <div class="stat-card">
                    <div class="stat-card-label">Total Applications</div>
                    <div class="stat-card-value" id="totalApps">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-label">Total Revenue</div>
                    <div class="stat-card-value">AED <span id="totalRevenue">0</span></div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-label">Young Icons (10-20)</div>
                    <div class="stat-card-value" id="youngIconsCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-label">Urban Millennial (21-40)</div>
                    <div class="stat-card-value" id="urbanMillennialCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-label">Legacy Builders (41-60)</div>
                    <div class="stat-card-value" id="legacyBuildersCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-card-label">Timeless Legends (60+)</div>
                    <div class="stat-card-value" id="timelessLegendsCount">0</div>
                </div>
            </div>

            <div class="data-table-container">
                <table class="data-table" id="applicationsTable">
                    <thead>
                        <tr>
                            <th>Participant</th>
                            <th>Mobile</th>
                            <th>Age</th>
                            <th>Category</th>
                            <th>Talent Type</th>
                            <th>DOB</th>
                            <th>Files</th>
                            <th>Payment</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="applicationsBody">
                        <tr>
                            <td colspan="10" style="text-align: center; padding: 3rem;">
                                Loading applications...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ==================== MODALS ==================== -->
   
    <!-- Admin Login Modal -->
    <div id="adminPasswordModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üîí Admin Login</h3>
                <button class="modal-close" onclick="closeAdminLogin()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Admin Password</label>
                    <input type="password" id="adminPassword" class="form-input" placeholder="Enter admin password" onkeypress="if(event.key==='Enter')verifyAdminPassword()">
                    <p class="form-helper">Default: admin123</p>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="verifyAdminPassword()" class="btn btn-primary" style="flex: 1;">Login</button>
                <button onclick="closeAdminLogin()" class="btn btn-secondary" style="flex: 1;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-body" style="padding: 2.5rem;">
                <div class="success-icon">‚úì</div>
                <h3 class="success-title">Application Submitted!</h3>
                <p class="success-message">
                    Thank you for registering! You will be informed of further steps via email within 3-5 business days.
                </p>
                <div class="success-details">
                    <div class="success-detail-row">
                        <span class="success-detail-label">Payment ID</span>
                        <span class="success-detail-value" id="successPaymentId">‚Äî</span>
                    </div>
                    <div class="success-detail-row">
                        <span class="success-detail-label">Amount</span>
                        <span class="success-detail-value">AED 55</span>
                    </div>
                    <div class="success-detail-row">
                        <span class="success-detail-label">Email</span>
                        <span class="success-detail-value" id="successEmail">‚Äî</span>
                    </div>
                    <div class="success-detail-row">
                        <span class="success-detail-label">Category</span>
                        <span class="success-detail-value" id="successCategory">‚Äî</span>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="generateReceipt()" class="btn btn-primary" style="flex: 1;">üìÑ Download Receipt</button>
                    <button onclick="closeSuccessModal()" class="btn btn-secondary" style="flex: 1;">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- File Viewer Modal -->
    <div id="fileViewerModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 class="modal-title">üìÇ File Preview</h3>
                <button class="modal-close" onclick="closeFileViewer()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="file-viewer-container" id="fileViewerContent">
                    <!-- File content will be loaded here -->
                </div>
            </div>
            <div class="modal-footer">
                <a id="downloadFileLink" href="#" download class="btn btn-primary" style="flex: 1;">‚¨áÔ∏è Download</a>
                <button onclick="closeFileViewer()" class="btn btn-secondary" style="flex: 1;">Close</button>
            </div>
        </div>
    </div>

    <!-- Application Details Modal -->
    <div id="applicationDetailsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">üìã Application Details</h3>
                <button class="modal-close" onclick="closeApplicationDetails()">√ó</button>
            </div>
            <div class="modal-body" id="applicationDetailsBody">
                <!-- Details will be populated -->
            </div>
            <div class="modal-footer">
                <button onclick="closeApplicationDetails()" class="btn btn-secondary" style="flex: 1;">Close</button>
            </div>
        </div>
    </div>
        <!-- Sponsor Contact Modal -->
    <div id="sponsorContactModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">ü§ù Become a Sponsor</h3>
                <button class="modal-close" onclick="closeSponsorModal()">√ó</button>
            </div>
            <div class="modal-body" style="text-align: center; padding: 2.5rem;">
                <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #f6cc68, #d4a84a); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 2.5rem;">
                    üíº
                </div>
                <h4 style="font-family: 'DM Serif Display', serif; font-size: 1.8rem; margin-bottom: 1rem; color: #f6cc68;">
                    Partner With Us
                </h4>
                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 2rem; line-height: 1.6;">
                    Join us as a sponsor and be part of the Arabian Talent League journey. 
                    Support emerging talents and gain exceptional brand visibility.
                </p>
                
                <div style="background: rgba(246, 204, 104, 0.1); border: 1px solid rgba(246, 204, 104, 0.3); border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem;">
                    <h5 style="color: #f6cc68; margin-bottom: 1rem; font-size: 1.1rem;">Contact Our Sponsorship Team</h5>
                    
                    <div style="display: flex; align-items: center; justify-content: center; gap: 0.75rem; margin-bottom: 0.75rem;">
                        <span style="font-size: 1.25rem;">üìß</span>
                        <a href="mailto:nanki@godspeed-events.com" style="color: #f6cc68; text-decoration: none; font-size: 1.05rem; font-weight: 600;">
                            nanki@godspeed-events.com
                        </a>
                    </div>
                    
                    <div style="display: flex; align-items: center; justify-content: center; gap: 0.75rem;">
                        <span style="font-size: 1.25rem;">üì±</span>
                        <a href="tel:+971505794074" style="color: #f6cc68; text-decoration: none; font-size: 1.05rem; font-weight: 600;">
                            +971 50 579 4074
                        </a>
                    </div>
                </div>

                <div style="background: rgba(1, 0, 0, 0.5); border-radius: 12px; padding: 1rem; margin-bottom: 1.5rem;">
                    <p style="font-size: 0.85rem; color: rgba(255, 255, 255, 0.6); margin: 0;">
                        <strong style="color: #f6cc68;">Office Hours:</strong><br>
                        Sunday - Thursday: 9:00 AM - 6:00 PM (UAE Time)
                    </p>
                </div>

                <button onclick="closeSponsorModal()" class="btn btn-primary" style="width: 100%;">
                    Close
                </button>
            </div>
        </div>
    </div>
        <script>
        // ==================== CONFIGURATION ====================
        const GOOGLE_CLIENT_ID = '510466997628-85povrl38c2ccinvgb7op6993q3514s3.apps.googleusercontent.com';
        const EMAILJS_PUBLIC_KEY = 'YZpoRY4fYkni2gA6H';
        const EMAILJS_SERVICE_ID = 'service_gjyxfni';
        const TEMPLATE_APPROVED = 'template_79rj8l7';
        const TEMPLATE_REJECTED = 'template_5z2riwt';
        const STRIPE_PUBLISHABLE_KEY = 'pk_test_51SaeBxJhxK58hO0hzxF2su6tmvNWLdqf0EZMTHVMly4BjXLybQeokHHq142ZJO1YFytZwvAPLCSOCH3ViQorta0C00I6PJI6EP';
        const REGISTRATION_FEE_AED = 55;
        const CURRENCY = 'AED';
        
        // Your Google Apps Script URL
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbxkBaiYSQSZ13Y9jw648rAmpQqdlQVfDReyKCESFWwHkvK53Qb9iC0xhIn2PTCrL4cjFw/exec';

        // Initialize EmailJS
        (function(){ emailjs.init(EMAILJS_PUBLIC_KEY); })();

        // Initialize Stripe
        const stripe = Stripe(STRIPE_PUBLISHABLE_KEY);

        // ==================== HELPER FUNCTIONS ====================
        function safeString(value) {
            if (value === null || value === undefined) return "";
            if (typeof value === "string") return value;
            if (Array.isArray(value)) return value.join(", ");
            if (typeof value === "object") {
                return value.name || value.description || value.text || JSON.stringify(value);
            }
            return String(value);
        }

        // ==================== STATE MANAGEMENT ====================
        let currentUser = null;
        let currentRole = null;
        let pendingApplication = null;
        let currentViewingApp = null;

        const sessionData = {
            applications: [],
            users: []
        };
                // ==================== SPONSOR MODAL FUNCTIONS ====================
        function showSponsorModal() {
            document.getElementById('sponsorContactModal')?.classList.add('active');
        }

        function closeSponsorModal() {
            document.getElementById('sponsorContactModal')?.classList.remove('active');
        }

        // ==================== COUNTRY CODES ====================
        const countryCodes = [
            { code: '+971', country: 'UAE', flag: 'üá¶üá™' },
            { code: '+91', country: 'India', flag: 'üáÆüá≥' }
        ];

        // ==================== TALENT CATEGORIES ====================
        const talentCategories = {
            'Performing Arts': [
                'Singing (Solo / Duo / Group)',
                'Instrumental Music (Classical, Fusion, Contemporary)',
                'Bands (Rock, Indie, Pop, Arabic Fusion, Asian Fusion, African rhythms)',
                'Dance (Bollywood, Hip-Hop, Classical, Contemporary, Latin, Afro, Folk)',
                'Theatre / Acting / Skits',
                'Spoken Word Poetry / Rap / Shayari'
            ],
            'Cultural & Traditional Arts': [
                'Folk dances (Indian, Filipino, African, Pakistani, Arab, Chinese, Western)',
                'Traditional music from any culture',
                'Cultural storytelling',
                'Poetry forms (Nabati, Urdu, Punjabi, Tagalog, English)'
            ],
            'Novelty Acts': [
                'Magic & Illusion',
                'Mentalism',
                'Ventriloquism',
                'Mime Acts',
                'Shadow Performances',
                'Quick Change Acts'
            ],
            'Circus, Physical & Fitness Skills': [
                'Acrobatics / Aerials (Silks, Hoop, Pole)',
                'Parkour / Freerunning',
                'Gymnastic Acts',
                'Stunt Performers',
                'Fire / LED Performers',
                'Juggling / Balance acts'
            ],
            'Visual & Creative Arts': [
                'Live Art / Speed Painting',
                'Sand Art',
                'Body Painting',
                'Calligraphy (Arabic, English, Asian scripts)',
                'Digital Art Performances',
                'Graffiti / Street Art',
                '3D Chalk Art'
            ],
            'Comedy, Story & Voice Arts': [
                'Stand-Up Comedy (all languages)',
                'Impressionists / Mimicry Artists',
                'Storytelling',
                'Voice Acting / Dubbing Artists'
            ],
            'Special & Unique Skills': [
                'Guinness-style Challenges',
                'Speed Solving (Rubik\'s Cube, puzzles)',
                'Memory Championships',
                'Unique talents (Yo-yo, diabolo, skipping, martial arts demos)'
            ],
            'Group & Community Talent': [
                'School Groups',
                'Community Clubs',
                'Corporate Teams',
                'Family Acts',
                'Choirs & Ensembles'
            ]
        };

        // ==================== AGE CATEGORIES (UPDATED) ====================
        function getAgeCategory(age) {
            if (age >= 10 && age <= 20) return 'Young Icons';
            if (age >= 21 && age <= 40) return 'Urban Millennial';
            if (age >= 41 && age <= 60) return 'Legacy Builders';
            if (age > 60) return 'Timeless Legends';
            return 'Invalid';
        }

        // ==================== INITIALIZATION ====================
        window.onload = function() {
            console.log('üöÄ Initializing Arabian Talent League...');
                handlePaymentReturn();

            // Initialize Google Sign-In
            if (typeof google !== 'undefined' && google.accounts) {
                google.accounts.id.initialize({
                    client_id: GOOGLE_CLIENT_ID,
                    callback: handleGoogleSignIn,
                    auto_select: false,
                    cancel_on_tap_outside: true
                });

                const googleBtnContainer = document.getElementById("googleSignInButton");
                if (googleBtnContainer) {
                    google.accounts.id.renderButton(googleBtnContainer, {
                        theme: "filled_blue",
                        size: "large",
                        width: 350,
                        text: "continue_with",
                        shape: "rectangular"
                    });
                }
            }

            initEventListeners();
            populateCountryCodes();
            populateTalentCategories();
            addAnimationStyles();
            
            console.log('‚úÖ Initialization complete');
        };

        function initEventListeners() {
            // Navbar scroll effect
            window.addEventListener('scroll', () => {
                const navbar = document.getElementById('navbar');
                if (navbar) {
                    navbar.classList.toggle('scrolled', window.scrollY > 50);
                }
            });

            // Character counter
            const textarea = document.getElementById('talentDescription');
            const charCount = document.getElementById('charCount');
            if (textarea && charCount) {
                textarea.addEventListener('input', function() {
                    charCount.textContent = this.value.length;
                });
            }

            // File input
            const fileInput = document.getElementById('fileUpload');
            if (fileInput) {
                fileInput.addEventListener('change', handleFileSelect);
            }

            // Form submission
            const form = document.getElementById('talentForm');
            if (form) {
                form.addEventListener('submit', handleFormSubmit);
            }

            // Talent category change
            const categorySelect = document.getElementById('talentCategory');
            if (categorySelect) {
                categorySelect.addEventListener('change', updateSubCategories);
            }

            // Admin password enter key
            const adminPasswordInput = document.getElementById('adminPassword');
            if (adminPasswordInput) {
                adminPasswordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') verifyAdminPassword();
                });
            }

            // Close modals on Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closeAllModals();
            });

            // Close modals on backdrop click
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) this.classList.remove('active');
                });
            });
        }

        function addAnimationStyles() {
            if (document.getElementById('dynamicStyles')) return;
            
            const style = document.createElement('style');
            style.id = 'dynamicStyles';
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
                @keyframes pulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.05); }
                }
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                .loading-spinner {
                    animation: spin 1s linear infinite;
                }
                .pulse-animation {
                    animation: pulse 0.5s ease;
                }
            `;
            document.head.appendChild(style);
        }

        function closeAllModals() {
            document.querySelectorAll('.modal-overlay').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        // ==================== POPULATE DROPDOWNS ====================
        function populateCountryCodes() {
            const select = document.getElementById('countryCode');
            if (!select) return;

            select.innerHTML = '<option value="">Select Country</option>';
            countryCodes.forEach(cc => {
                select.innerHTML += `<option value="${cc.code}">${cc.flag} ${cc.country} (${cc.code})</option>`;
            });
        }

        function populateTalentCategories() {
            const select = document.getElementById('talentCategory');
            if (!select) return;

            select.innerHTML = '<option value="">Select Talent Category</option>';
            Object.keys(talentCategories).forEach(category => {
                select.innerHTML += `<option value="${category}">${category}</option>`;
            });
        }

        function updateSubCategories() {
            const categorySelect = document.getElementById('talentCategory');
            const subCategorySelect = document.getElementById('talentSubCategory');
            if (!categorySelect || !subCategorySelect) return;

            const selectedCategory = categorySelect.value;
            subCategorySelect.innerHTML = '<option value="">Select Sub-Category</option>';

            if (selectedCategory && talentCategories[selectedCategory]) {
                talentCategories[selectedCategory].forEach(sub => {
                    subCategorySelect.innerHTML += `<option value="${sub}">${sub}</option>`;
                });
                subCategorySelect.disabled = false;
            } else {
                subCategorySelect.disabled = true;
            }
        }

        // ==================== AGE CALCULATION ====================
        function calculateAge() {
            const dobInput = document.getElementById('dateOfBirth');
            const ageDisplay = document.getElementById('ageDisplay');
            const submitBtn = document.getElementById('submitBtn');
            
            if (!dobInput || !dobInput.value) {
                if (ageDisplay) ageDisplay.innerHTML = '';
                return null;
            }

            const dob = new Date(dobInput.value);
            const today = new Date();
            let age = today.getFullYear() - dob.getFullYear();
            const monthDiff = today.getMonth() - dob.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
                age--;
            }

            const category = getAgeCategory(age);

            if (age < 10) {
                ageDisplay.innerHTML = `
                    <div class="age-warning">
                        <span>‚ö†Ô∏è</span>
                        <span>Minimum age is 10 years. You are not eligible.</span>
                    </div>`;
                if (submitBtn) submitBtn.disabled = true;
                return null;
            }

            ageDisplay.innerHTML = `
                <div class="age-badge">
                    <span class="age-value">${age} years</span>
                    <span class="category-badge">${category}</span>
                </div>`;
            if (submitBtn) submitBtn.disabled = false;

            return { age, category };
        }

        // ==================== FILE HANDLING ====================
        function handleFileSelect() {
            const files = this.files;
            const filesList = document.getElementById('filesList');
            const fileSize = document.getElementById('fileSize');
            
            if (!filesList || !fileSize) return;

            if (files.length > 0) {
                let totalSize = 0;
                let html = '';
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
                    totalSize += file.size;
                    
                    const icon = getFileIcon(file.name);
                    const isOversized = file.size > 50 * 1024 * 1024;
                    
                    html += `
                        <div class="file-item" style="${isOversized ? 'border-color: rgba(239,68,68,0.5); background: rgba(239,68,68,0.1);' : ''}">
                            <span class="file-item-name">${icon} ${file.name}</span>
                            <span class="file-item-size" style="${isOversized ? 'color: #F87171;' : ''}">${sizeMB} MB ${isOversized ? '‚ùå' : '‚úÖ'}</span>
                        </div>`;
                }
                
                filesList.innerHTML = html;
                fileSize.textContent = `Total: ${(totalSize / (1024 * 1024)).toFixed(2)} MB (${files.length} file${files.length > 1 ? 's' : ''})`;
            } else {
                filesList.innerHTML = '';
                fileSize.textContent = '';
            }
        }

        function getFileIcon(filename) {
            const ext = filename.toLowerCase();
            if (ext.match(/\.(jpg|jpeg|png|gif|webp|bmp)$/)) return 'üñºÔ∏è';
            if (ext.match(/\.(mp4|mov|avi|webm|mkv)$/)) return 'üé¨';
            if (ext.match(/\.(mp3|wav|ogg|m4a|flac)$/)) return 'üéµ';
            if (ext.match(/\.pdf$/)) return 'üìë';
            return 'üìÑ';
        }

        // ==================== GOOGLE SHEETS FUNCTIONS ====================
        async function saveToGoogleSheets(data) {
            try {
                console.log('üì§ Saving to Google Sheets & Drive...');
                
                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    body: JSON.stringify({
                        action: 'saveApplication',
                        data: data
                    })
                });
                
                let result;
                try {
                    result = await response.json();
                } catch (e) {
                    result = { success: true };
                }
                
                if (result.success) {
                    console.log('‚úÖ Saved successfully!');
                    console.log('üìÅ Drive URLs:', result.driveUrls);
                    data.driveUrls = result.driveUrls || [];
                    data.folderUrl = result.folderUrl || '';
                }
                
                return result;
            } catch (error) {
                console.error('‚ùå Save error:', error);
                return { success: false, error: error.message };
            }
        }

        async function loadFromGoogleSheets() {
            try {
                console.log('üì• Loading applications...');
                
                const response = await fetch(`${GOOGLE_SHEETS_URL}?action=getApplications`);
                const text = await response.text();
                
                console.log('üìÑ Raw response length:', text.length);
                
                let result;
                try {
                    result = JSON.parse(text);
                } catch (e) {
                    console.error('JSON parse error:', e);
                    throw new Error('Invalid response from server');
                }
                
                if (result.success && result.applications) {
                    console.log('‚úÖ Loaded', result.applications.length, 'applications');
                    return result.applications;
                } else if (result.error) {
                    throw new Error(result.error);
                }
                
                return [];
            } catch (error) {
                console.error('‚ùå Load error:', error);
                throw error;
            }
        }

        async function updateStatusInGoogleSheets(id, status) {
            try {
                console.log(`üì§ Updating status: ${id} ‚Üí ${status}`);
                
                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    body: JSON.stringify({
                        action: 'updateStatus',
                        id: String(id),
                        status: status
                    })
                });
                
                let result;
                try {
                    result = await response.json();
                } catch (e) {
                    result = { success: true };
                }
                
                console.log('üì• Update result:', result);
                return result;
            } catch (error) {
                console.error('‚ùå Update error:', error);
                return { success: false, error: error.message };
            }
        }

        // ==================== AUTH FUNCTIONS ====================
        function handleGoogleSignIn(response) {
            const credential = parseJwt(response.credential);
            if (!credential) {
                showNotification('error', 'Failed to sign in');
                return;
            }

            let user = sessionData.users.find(u => u.email === credential.email);
            if (!user) {
                user = {
                    id: Date.now(),
                    googleId: credential.sub,
                    name: credential.name,
                    email: credential.email,
                    photoURL: credential.picture,
                    hasApplied: false,
                    authProvider: 'google',
                    createdAt: new Date().toISOString()
                };
                sessionData.users.push(user);
            }
            
            currentUser = user;
            currentRole = 'user';
            updateAuthButton();
            backToPublicPage();
            showNotification('success', `Welcome ${credential.name}!`);
        }

        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                return JSON.parse(decodeURIComponent(atob(base64).split('').map(c =>
                    '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
                ).join('')));
            } catch (e) {
                return null;
            }
        }

        function updateAuthButton() {
            const navActions = document.getElementById('navActions');
            if (!navActions) return;
            
            if (currentUser) {
                navActions.innerHTML = `
                    <div class="user-profile-btn">
                        ${currentUser.photoURL 
                            ? `<img src="${currentUser.photoURL}" class="user-profile-avatar" alt="${currentUser.name}">`
                            : `<div class="user-profile-avatar" style="background: linear-gradient(45deg, #9C9677, #f6cc68); display: flex; align-items: center; justify-content: center; font-weight: 700; color: #010000;">${currentUser.name.charAt(0).toUpperCase()}</div>`
                        }
                        <span class="user-profile-name">${currentUser.name.split(' ')[0]}</span>
                    </div>
                    <button onclick="logout()" class="btn btn-ghost">Logout</button>
                    <button onclick="showAdminLogin()" class="btn btn-ghost">Admin</button>
                `;
            } else {
                navActions.innerHTML = `
                    <button onclick="showUserLoginPage()" class="btn btn-secondary">Sign In</button>
                    <button onclick="showAdminLogin()" class="btn btn-ghost">Admin</button>
                `;
            }
        }

        // ==================== NAVIGATION ====================
        function handleApplyNow() {
            if (!currentUser) {
                showNotification('warning', 'Please sign in to apply!');
                showUserLoginPage();
                return;
            }

            const existing = sessionData.applications.find(app => 
                app.userEmail === currentUser.email || app.email === currentUser.email
            );
            if (existing) {
                showNotification('warning', `Already applied! Status: ${existing.status}`);
                return;
            }

            showApplicationForm();
        }

        function showUserLoginPage() {
            document.getElementById('publicPage')?.classList.add('hidden');
            document.getElementById('adminDashboard')?.classList.add('hidden');
            const loginPage = document.getElementById('userLoginPage');
            if (loginPage) {
                loginPage.classList.remove('hidden');
                loginPage.style.display = 'flex';
            }
        }

        function backToPublicPage() {
            const loginPage = document.getElementById('userLoginPage');
            if (loginPage) {
                loginPage.classList.add('hidden');
                loginPage.style.display = 'none';
            }
            document.getElementById('adminDashboard')?.classList.add('hidden');
            document.getElementById('publicPage')?.classList.remove('hidden');
        }

        function showApplicationForm() {
            const emailInput = document.getElementById('email');
            const nameInput = document.getElementById('fullName');
            if (emailInput) emailInput.value = currentUser.email;
            if (nameInput) nameInput.value = currentUser.name;
            
            const section = document.getElementById('applicationSection');
            if (section) {
                section.classList.remove('hidden');
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function hideApplicationForm() {
            document.getElementById('applicationSection')?.classList.add('hidden');
            document.getElementById('talentForm')?.reset();
            
            const elements = {
                charCount: '0',
                fileSize: '',
                ageDisplay: '',
                filesList: ''
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const el = document.getElementById(id);
                if (el) el.textContent !== undefined ? el.textContent = value : el.innerHTML = value;
            });
            
            const subCat = document.getElementById('talentSubCategory');
            if (subCat) {
                subCat.innerHTML = '<option value="">Select Sub-Category</option>';
                subCat.disabled = true;
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ==================== EMAIL/PASSWORD AUTH ====================
        function toggleToRegister() {
            document.getElementById('loginForm')?.classList.add('hidden');
            document.getElementById('registerForm')?.classList.remove('hidden');
        }

        function toggleToLogin() {
            document.getElementById('registerForm')?.classList.add('hidden');
            document.getElementById('loginForm')?.classList.remove('hidden');
        }

        function registerUser() {
            const name = document.getElementById('registerName')?.value.trim();
            const email = document.getElementById('registerEmail')?.value.trim();
            const password = document.getElementById('registerPassword')?.value;
            const confirmPassword = document.getElementById('registerConfirmPassword')?.value;

            if (!name || !email || !password || !confirmPassword) {
                showNotification('error', 'Please fill all fields!');
                return;
            }

            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                showNotification('error', 'Invalid email format!');
                return;
            }

            if (password.length < 6) {
                showNotification('error', 'Password must be 6+ characters!');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('error', 'Passwords do not match!');
                return;
            }

            if (sessionData.users.find(u => u.email === email)) {
                showNotification('error', 'Email already registered!');
                return;
            }

            sessionData.users.push({
                id: Date.now(),
                name, email, password,
                hasApplied: false,
                authProvider: 'email',
                createdAt: new Date().toISOString()
            });

            showNotification('success', 'Registration successful!');
            ['registerName', 'registerEmail', 'registerPassword', 'registerConfirmPassword']
                .forEach(id => { const el = document.getElementById(id); if (el) el.value = ''; });
            toggleToLogin();
        }

        function loginUser() {
            const email = document.getElementById('loginEmail')?.value.trim();
            const password = document.getElementById('loginPassword')?.value;

            if (!email || !password) {
                showNotification('error', 'Enter email and password!');
                return;
            }

            const user = sessionData.users.find(u => u.email === email && u.password === password);
            if (!user) {
                showNotification('error', 'Invalid credentials!');
                return;
            }

            currentUser = user;
            currentRole = 'user';
            updateAuthButton();
            backToPublicPage();
            showNotification('success', `Welcome ${user.name}!`);
        }

        // ==================== ADMIN ====================
        function showAdminLogin() {
            document.getElementById('adminPasswordModal')?.classList.add('active');
            setTimeout(() => document.getElementById('adminPassword')?.focus(), 100);
        }

        function closeAdminLogin() {
            document.getElementById('adminPasswordModal')?.classList.remove('active');
            const input = document.getElementById('adminPassword');
            if (input) input.value = '';
        }

        function verifyAdminPassword() {
            const password = document.getElementById('adminPassword')?.value;
            if (password === 'admin123') {
                currentUser = { name: 'Admin', role: 'admin' };
                currentRole = 'admin';
                closeAdminLogin();
                showAdminDashboard();
                showNotification('success', 'Welcome Admin!');
            } else {
                showNotification('error', 'Invalid password!');
            }
        }

        function showAdminDashboard() {
            document.getElementById('publicPage')?.classList.add('hidden');
            document.getElementById('userLoginPage')?.classList.add('hidden');
            document.getElementById('adminDashboard')?.classList.remove('hidden');
            loadApplications();
        }

        function logout() {
            if (currentUser?.authProvider === 'google' && typeof google !== 'undefined') {
                google.accounts.id.disableAutoSelect();
            }
            currentUser = null;
            currentRole = null;
            updateAuthButton();
            document.getElementById('adminDashboard')?.classList.add('hidden');
            document.getElementById('publicPage')?.classList.remove('hidden');
            hideApplicationForm();
            showNotification('success', 'Logged out!');
        }
                // ==================== PAYMENT ====================
        // ==================== STRIPE PAYMENT (PAYMENT LINK) ====================
async function processStripePayment() {
    const btn = document.getElementById('submitBtn');
    const originalText = btn?.innerHTML;
    
    try {
        if (btn) {
            btn.innerHTML = '‚è≥ Preparing payment...';
            btn.disabled = true;
        }

        // Collect all form data including files
        const fileInput = document.getElementById('fileUpload');
        const files = fileInput.files;
        const fileNames = [];
        const fileTypes = [];
        const fileDataArray = [];

        // Process files to base64
        for (let i = 0; i < files.length; i++) {
            if (files[i].size > 50 * 1024 * 1024) {
                throw new Error(`File too large: ${files[i].name}`);
            }
            fileNames.push(files[i].name);
            fileTypes.push(files[i].type);
            
            const base64 = await new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.readAsDataURL(files[i]);
            });
            fileDataArray.push(base64);
        }

        // Get age data
        const ageData = calculateAge();

        // Prepare complete form data
        const formData = {
            id: Date.now(),
            userEmail: currentUser.email,
            userName: currentUser.name,
            userPhoto: currentUser.photoURL || null,
            name: document.getElementById('fullName')?.value,
            email: document.getElementById('email')?.value,
            countryCode: document.getElementById('countryCode')?.value,
            mobile: document.getElementById('countryCode')?.value + document.getElementById('mobile')?.value,
            dob: document.getElementById('dateOfBirth')?.value,
            age: ageData?.age,
            ageCategory: ageData?.category,
            talentCategory: document.getElementById('talentCategory')?.value,
            talentSubCategory: document.getElementById('talentSubCategory')?.value || '',
            talent: document.getElementById('talentDescription')?.value,
            performanceLink: document.getElementById('performanceLink')?.value || '',
            files: files.length,
            fileNames: fileNames,
            fileTypes: fileTypes,
            fileData: fileDataArray,
            status: 'Pending',
            paymentAmount: REGISTRATION_FEE_AED,
            paymentCurrency: CURRENCY,
            createdAt: new Date().toISOString()
        };

        // Store in localStorage (survives page redirect)
        localStorage.setItem('ATL_pendingRegistration', JSON.stringify(formData));
        
        if (btn) {
            btn.innerHTML = 'üí≥ Redirecting to Stripe...';
        }

        // Small delay for better UX
        await new Promise(resolve => setTimeout(resolve, 500));

        // Redirect to Stripe payment link
        window.location.href = 'https://buy.stripe.com/test_6oU28s4qtdsBa0dcPx3gk00';

    } catch (error) {
        console.error('Payment preparation error:', error);
        showNotification('error', 'Failed to prepare payment: ' + error.message);
        
        if (btn) {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    }
}
// ==================== HANDLE PAYMENT RETURN ====================
async function handlePaymentReturn() {
    const urlParams = new URLSearchParams(window.location.search);
    
    if (urlParams.get('payment') === 'success') {
        // Show loading state
        showNotification('info', '‚è≥ Completing your registration...');
        
        // Retrieve stored form data
        const pendingDataStr = localStorage.getItem('ATL_pendingRegistration');
        
        if (pendingDataStr) {
            try {
                const formData = JSON.parse(pendingDataStr);
                
                // Add payment details
                formData.paymentId = 'stripe_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                formData.paymentStatus = 'Paid';
                formData.submittedAt = new Date().toLocaleString();
                
                // Save to Google Sheets
                const result = await saveToGoogleSheets(formData);
                
                if (result.success !== false) {
                    // Success! Store for receipt
                    const appToStore = { ...formData };
                    delete appToStore.fileData; // Remove base64 data
                    appToStore.driveUrls = result.driveUrls || [];
                    appToStore.folderUrl = result.folderUrl || '';
                    
                    sessionData.applications.push(appToStore);
                    pendingApplication = appToStore;
                    
                    if (currentUser) {
                        currentUser.hasApplied = true;
                    }
                    
                    // Clear stored data
                    localStorage.removeItem('ATL_pendingRegistration');
                    
                    // Update success modal
                    document.getElementById('successPaymentId').textContent = formData.paymentId;
                    document.getElementById('successEmail').textContent = formData.email;
                    document.getElementById('successCategory').textContent = formData.talentCategory;
                    
                    // Show success modal
                    document.getElementById('successModal')?.classList.add('active');
                    
                    showNotification('success', 'üéâ Registration completed successfully!');
                    
                    // Hide application form if visible
                    hideApplicationForm();
                    
                    // Clean URL
                    window.history.replaceState({}, document.title, '/');
                } else {
                    throw new Error('Failed to save registration');
                }
                
            } catch (error) {
                console.error('Registration completion error:', error);
                showNotification('error', 'Registration failed. Please contact support with your payment confirmation.');
            }
        } else {
            showNotification('warning', 'Session expired. If you paid, please contact support.');
            window.history.replaceState({}, document.title, '/');
        }
    } else if (urlParams.get('payment') === 'cancelled') {
        showNotification('warning', 'Payment was cancelled. Your form data has been saved.');
        window.history.replaceState({}, document.title, '/');
        
        // Restore form if user wants to try again
        const pendingDataStr = localStorage.getItem('ATL_pendingRegistration');
        if (pendingDataStr) {
            showNotification('info', 'Click "Apply Now" to try again with your saved data.');
        }
    }
}
        // ==================== FORM SUBMISSION ====================
        // ==================== FORM SUBMISSION ====================
async function handleFormSubmit(e) {
    e.preventDefault();

    if (!currentUser) {
        showNotification('error', 'Please login first!');
        return;
    }

    const ageData = calculateAge();
    if (!ageData) {
        showNotification('error', 'Please enter valid date of birth!');
        return;
    }

    const countryCode = document.getElementById('countryCode')?.value;
    const talentCategory = document.getElementById('talentCategory')?.value;
    const mobile = document.getElementById('mobile')?.value;
    const talentDescription = document.getElementById('talentDescription')?.value;

    if (!countryCode || !talentCategory || !mobile || mobile.length < 7) {
        showNotification('error', 'Please fill all required fields!');
        return;
    }

    if (!talentDescription || talentDescription.length < 50) {
        showNotification('error', 'Describe your talent (min 50 chars)!');
        return;
    }

    const fileInput = document.getElementById('fileUpload');
    if (!fileInput?.files.length) {
        showNotification('error', 'Please upload at least one file!');
        return;
    }

    // Check file sizes
    for (let i = 0; i < fileInput.files.length; i++) {
        if (fileInput.files[i].size > 50 * 1024 * 1024) {
            showNotification('error', `File too large: ${fileInput.files[i].name} (max 50MB)`);
            return;
        }
    }

    try {
        // Process payment (will redirect to Stripe)
        await processStripePayment();
        
    } catch (error) {
        console.error('Submission error:', error);
        showNotification('error', error.message || 'Submission failed');
    }
}

        function closeSuccessModal() {
            document.getElementById('successModal')?.classList.remove('active');
            hideApplicationForm();
        }

        // ==================== ADMIN - LOAD APPLICATIONS ====================
        async function loadApplications() {
            const body = document.getElementById('applicationsBody');
            if (!body) return;

            body.innerHTML = `
                <tr>
                    <td colspan="10" style="text-align: center; padding: 3rem;">
                        <div class="loading-spinner" style="font-size: 2rem; margin-bottom: 1rem;">‚è≥</div>
                        <div>Loading applications from Google Sheets...</div>
                    </td>
                </tr>`;

            try {
                const sheetApps = await loadFromGoogleSheets();
                
                // Merge with session data
                const allApps = [...sheetApps];
                sessionData.applications.forEach(app => {
                    if (!allApps.find(a => String(a.id) === String(app.id))) {
                        allApps.push(app);
                    }
                });

                if (allApps.length === 0) {
                    body.innerHTML = `
                        <tr>
                            <td colspan="10" style="text-align: center; padding: 3rem; color: rgba(255,255,255,0.5);">
                                <div style="font-size: 3rem; margin-bottom: 1rem;">üì≠</div>
                                <div>No applications yet</div>
                            </td>
                        </tr>`;
                    updateStats([]);
                    return;
                }

                // Sort by date
                allApps.sort((a, b) => {
                    try { return new Date(b.submittedAt) - new Date(a.submittedAt); }
                    catch { return 0; }
                });

                sessionData.applications = allApps;

                // Build table rows
                body.innerHTML = allApps.map(app => buildApplicationRow(app)).join('');
                updateStats(allApps);

            } catch (error) {
                console.error('Load error:', error);
                body.innerHTML = `
                    <tr>
                        <td colspan="10" style="text-align: center; padding: 3rem; color: #F87171;">
                            <div style="font-size: 2rem; margin-bottom: 1rem;">‚ùå</div>
                            <div>Error: ${error.message}</div>
                            <button onclick="loadApplications()" class="btn btn-primary" style="margin-top: 1rem;">üîÑ Retry</button>
                        </td>
                    </tr>`;
            }
        }

        function buildApplicationRow(app) {
            const status = app.status || 'Pending';
            const statusClass = status.toLowerCase();
            const driveUrls = app.driveUrls || [];
            const fileNames = app.fileNames || [];
            
            // Safe string conversion for talent field
            const talentText = safeString(app.talent);

            // Build file links
            let filesHtml = '<span style="color: rgba(255,255,255,0.4); font-size: 0.8rem;">No files</span>';
            if (driveUrls.length > 0) {
                filesHtml = `
                    <div style="display: flex; flex-direction: column; gap: 3px; max-height: 80px; overflow-y: auto;">
                        ${driveUrls.slice(0, 3).map((url, i) => {
                            const name = fileNames[i] || `File ${i + 1}`;
                            const shortName = name.length > 15 ? name.substring(0, 15) + '...' : name;
                            const icon = getFileIcon(name);
                            return `<a href="${url}" target="_blank" style="display: flex; align-items: center; gap: 4px; color: #f6cc68; text-decoration: none; font-size: 0.75rem; padding: 2px 6px; background: rgba(246,204,104,0.1); border-radius: 4px;" title="${name}">${icon} ${shortName}</a>`;
                        }).join('')}
                        ${driveUrls.length > 3 ? `<span style="font-size: 0.7rem; color: rgba(255,255,255,0.5);">+${driveUrls.length - 3} more</span>` : ''}
                    </div>
                    ${app.folderUrl ? `<a href="${app.folderUrl}" target="_blank" style="display: inline-block; margin-top: 4px; color: #f6cc68; font-size: 0.7rem; text-decoration: none;">üìÇ Folder</a>` : ''}
                `;
            }

            // Action buttons based on status
            let actionBtns = '';
            if (status === 'Pending') {
                actionBtns = `
                    <button class="action-btn action-btn-approve" onclick="approveApplication('${app.id}')">‚úì Approve</button>
                    <button class="action-btn action-btn-reject" onclick="rejectApplication('${app.id}')">‚úó Reject</button>
                `;
            } else if (status === 'Approved') {
                actionBtns = `
                    <button class="action-btn action-btn-reject" onclick="rejectApplication('${app.id}')">‚úó Reject</button>
                    <button class="action-btn action-btn-reset" onclick="resetToPending('${app.id}')" style="background: rgba(156,150,119,0.2); color: #9C9677;">‚Ü∫ Reset</button>
                `;
            } else {
                actionBtns = `
                    <button class="action-btn action-btn-approve" onclick="approveApplication('${app.id}')">‚úì Approve</button>
                    <button class="action-btn action-btn-reset" onclick="resetToPending('${app.id}')" style="background: rgba(156,150,119,0.2); color: #9C9677;">‚Ü∫ Reset</button>
                `;
            }

            return `
                <tr data-id="${app.id}">
                    <td>
                        <div class="user-cell">
                            ${app.userPhoto 
                                ? `<img src="${app.userPhoto}" class="user-avatar" alt="">` 
                                : `<div class="user-avatar-placeholder">${(app.userName || app.name || 'U').charAt(0).toUpperCase()}</div>`
                            }
                            <div>
                                <div class="user-info-name">${app.userName || app.name || '‚Äî'}</div>
                                <div class="user-info-email">${app.userEmail || app.email || '‚Äî'}</div>
                            </div>
                        </div>
                    </td>
                    <td>${app.mobile || '‚Äî'}</td>
                    <td>
                        <div>${app.age || '‚Äî'} yrs</div>
                        <span class="category-badge" style="font-size: 0.65rem;">${app.ageCategory || '‚Äî'}</span>
                    </td>
                    <td>
                        <div style="font-weight: 600; font-size: 0.85rem;">${safeString(app.talentCategory) || '‚Äî'}</div>
                        <div style="font-size: 0.7rem; color: rgba(255,255,255,0.5);">${safeString(app.talentSubCategory) || ''}</div>
                    </td>
                    <td style="max-width: 120px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${talentText.replace(/"/g, '&quot;')}">
                        ${talentText.slice(0, 50) || '‚Äî'}...
                    </td>
                    <td>${app.dob || '‚Äî'}</td>
                    <td style="min-width: 150px;">${filesHtml}</td>
                    <td style="color: #4ade80; font-weight: 700;">AED ${app.paymentAmount || 55}</td>
                    <td><span class="status-badge status-${statusClass}" id="status-${app.id}">${status}</span></td>
                    <td>
                        <div class="action-btns" id="actions-${app.id}" style="flex-direction: column; gap: 4px;">
                            <button class="action-btn action-btn-view" onclick="viewApplicationDetails('${app.id}')" style="width: 100%;">üëÅÔ∏è View</button>
                            ${actionBtns}
                        </div>
                    </td>
                </tr>
            `;
        }

        // ==================== STATUS CHANGE FUNCTIONS ====================
        function approveApplication(id) {
            const app = sessionData.applications.find(a => String(a.id) === String(id));
            if (!app) return showNotification('error', 'Application not found!');

            if (confirm(`‚úÖ APPROVE\n\n${app.userName || app.name}\n${app.talentCategory}\n\nProceed?`)) {
                changeApplicationStatus(id, 'Approved');
            }
        }

        function rejectApplication(id) {
            const app = sessionData.applications.find(a => String(a.id) === String(id));
            if (!app) return showNotification('error', 'Application not found!');

            if (confirm(`‚ùå REJECT\n\n${app.userName || app.name}\n${app.talentCategory}\n\nProceed?`)) {
                changeApplicationStatus(id, 'Rejected');
            }
        }

        function resetToPending(id) {
            if (confirm('Reset to Pending?')) {
                changeApplicationStatus(id, 'Pending');
            }
        }

        async function changeApplicationStatus(id, newStatus) {
            const actionsDiv = document.getElementById(`actions-${id}`);
            const statusBadge = document.getElementById(`status-${id}`);
            
            if (actionsDiv) {
                actionsDiv.innerHTML = `
                    <div style="text-align: center; padding: 0.5rem;">
                        <div class="loading-spinner" style="font-size: 1.25rem;">‚è≥</div>
                        <div style="color: #f6cc68; font-size: 0.75rem;">Updating...</div>
                    </div>
                `;
            }

            try {
                const result = await updateStatusInGoogleSheets(id, newStatus);
                
                if (result.success !== false) {
                    // Update local data
                    const idx = sessionData.applications.findIndex(a => String(a.id) === String(id));
                    if (idx !== -1) sessionData.applications[idx].status = newStatus;

                    // Update UI
                    if (statusBadge) {
                        statusBadge.className = `status-badge status-${newStatus.toLowerCase()}`;
                        statusBadge.textContent = newStatus;
                        statusBadge.classList.add('pulse-animation');
                        setTimeout(() => statusBadge.classList.remove('pulse-animation'), 500);
                    }

                    updateActionButtons(id, newStatus);
                    updateStats(sessionData.applications);
                    
                    const emoji = { Approved: '‚úÖ', Rejected: '‚ùå', Pending: '‚è≥' }[newStatus];
                    showNotification('success', `${emoji} Status: ${newStatus}`);

                    // Send email
                    if (newStatus !== 'Pending') {
                        const app = sessionData.applications.find(a => String(a.id) === String(id));
                        if (app) sendStatusEmail(app, newStatus);
                    }
                } else {
                    throw new Error(result.error || 'Update failed');
                }
            } catch (error) {
                console.error('Status update error:', error);
                showNotification('error', 'Update failed: ' + error.message);
                
                const app = sessionData.applications.find(a => String(a.id) === String(id));
                if (app) updateActionButtons(id, app.status || 'Pending');
            }
        }

        function updateActionButtons(id, status) {
            const actionsDiv = document.getElementById(`actions-${id}`);
            if (!actionsDiv) return;

            let btns = '';
            if (status === 'Pending') {
                btns = `
                    <button class="action-btn action-btn-approve" onclick="approveApplication('${id}')">‚úì Approve</button>
                    <button class="action-btn action-btn-reject" onclick="rejectApplication('${id}')">‚úó Reject</button>
                `;
            } else if (status === 'Approved') {
                btns = `
                    <button class="action-btn action-btn-reject" onclick="rejectApplication('${id}')">‚úó Reject</button>
                    <button class="action-btn action-btn-reset" onclick="resetToPending('${id}')" style="background: rgba(156,150,119,0.2); color: #9C9677;">‚Ü∫ Reset</button>
                `;
            } else {
                btns = `
                    <button class="action-btn action-btn-approve" onclick="approveApplication('${id}')">‚úì Approve</button>
                    <button class="action-btn action-btn-reset" onclick="resetToPending('${id}')" style="background: rgba(156,150,119,0.2); color: #9C9677;">‚Ü∫ Reset</button>
                `;
            }

            actionsDiv.innerHTML = `
                <button class="action-btn action-btn-view" onclick="viewApplicationDetails('${id}')" style="width: 100%;">üëÅÔ∏è View</button>
                ${btns}
            `;
        }

        function sendStatusEmail(app, status) {
            try {
                const template = status === 'Approved' ? TEMPLATE_APPROVED : TEMPLATE_REJECTED;
                emailjs.send(EMAILJS_SERVICE_ID, template, {
                    to_email: app.userEmail || app.email,
                    to_name: app.userName || app.name,
                    status: status,
                    talent_category: app.talentCategory || 'N/A'
                }).then(() => console.log('‚úÖ Email sent'))
                  .catch(e => console.warn('Email failed:', e));
            } catch (e) {
                console.warn('EmailJS error:', e);
            }
        }

        // ==================== STATS (UPDATED CATEGORIES) ====================
        function updateStats(apps) {
            const setEl = (id, val) => { 
                const el = document.getElementById(id); 
                if (el) el.textContent = val; 
            };
            
            setEl('totalApps', apps.length);
            setEl('totalRevenue', apps.reduce((s, a) => s + (parseFloat(a.paymentAmount) || 0), 0).toFixed(0));
            
            // Updated category names
            const counts = { 
                'Young Icons': 0, 
                'Urban Millennial': 0, 
                'Legacy Builders': 0, 
                'Timeless Legends': 0 
            };
            
            apps.forEach(a => { 
                if (counts[a.ageCategory] !== undefined) counts[a.ageCategory]++; 
            });
            
            setEl('youngIconsCount', counts['Young Icons']);
            setEl('urbanMillennialCount', counts['Urban Millennial']);
            setEl('legacyBuildersCount', counts['Legacy Builders']);
            setEl('timelessLegendsCount', counts['Timeless Legends']);
        }
                // ==================== VIEW APPLICATION DETAILS ====================
        function viewApplicationDetails(appId) {
            const app = sessionData.applications.find(a => String(a.id) === String(appId));
            if (!app) return showNotification('error', 'Not found!');

            currentViewingApp = app;
            const driveUrls = app.driveUrls || [];
            const fileNames = app.fileNames || [];

            const content = document.getElementById('applicationDetailsBody');
            if (!content) {
                console.error('Modal content element not found!');
                return;
            }

            // Build files section
            let filesHtml = '<div style="text-align: center; padding: 2rem; color: rgba(255,255,255,0.5);">üì≠ No files</div>';
            
            if (driveUrls.length > 0) {
                filesHtml = `
                    <div style="display: grid; gap: 0.75rem; max-height: 400px; overflow-y: auto;">
                        ${driveUrls.map((url, i) => {
                            const name = fileNames[i] || `File ${i + 1}`;
                            const icon = getFileIcon(name);
                            const fileId = url.match(/\/d\/([^\/]+)/)?.[1] || '';
                            const downloadUrl = fileId ? `https://drive.google.com/uc?export=download&id=${fileId}` : url;
                            const previewUrl = fileId ? `https://drive.google.com/file/d/${fileId}/preview` : '';
                            
                            let preview = '';
                            if (name.match(/\.(jpg|jpeg|png|gif|webp|pdf|mp4|mov)$/i) && previewUrl) {
                                preview = `<iframe src="${previewUrl}" style="width: 100%; height: 200px; border: none; border-radius: 8px; margin-top: 10px; background: #000;"></iframe>`;
                            }
                            
                            return `
                                <div style="background: rgba(8,4,4,0.6); border: 1px solid rgba(246,204,104,0.3); border-radius: 12px; padding: 1rem;">
                                    <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 0.5rem;">
                                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                                            <span style="font-size: 1.75rem;">${icon}</span>
                                            <span style="color: #fff; font-weight: 600;">${name}</span>
                                        </div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <a href="${url}" target="_blank" class="btn btn-ghost" style="padding: 0.4rem 0.75rem; font-size: 0.8rem;">üëÅÔ∏è View</a>
                                            <a href="${downloadUrl}" target="_blank" class="btn btn-primary" style="padding: 0.4rem 0.75rem; font-size: 0.8rem;">‚¨áÔ∏è Download</a>
                                        </div>
                                    </div>
                                    ${preview}
                                </div>
                            `;
                        }).join('')}
                    </div>
                    ${app.folderUrl ? `<a href="${app.folderUrl}" target="_blank" class="btn btn-primary" style="margin-top: 1rem; width: 100%;">üìÇ Open All in Drive</a>` : ''}
                `;
            }

            // Build action buttons based on status
            const status = safeString(app.status) || 'Pending';
            let actionButtonsHtml = '';
            
            if (status === 'Pending') {
                actionButtonsHtml = `
                    <button onclick="approveApplication('${app.id}'); closeApplicationDetails();" class="btn" style="padding: 0.875rem; background: rgba(34,197,94,0.3); border: 2px solid rgba(34,197,94,0.5); color: #4ade80; font-weight: 600; flex: 1;">
                        ‚úì Approve
                    </button>
                    <button onclick="rejectApplication('${app.id}'); closeApplicationDetails();" class="btn" style="padding: 0.875rem; background: rgba(239,68,68,0.3); border: 2px solid rgba(239,68,68,0.5); color: #F87171; font-weight: 600; flex: 1;">
                        ‚úó Reject
                    </button>
                `;
            } else if (status === 'Approved') {
                actionButtonsHtml = `
                    <button onclick="rejectApplication('${app.id}'); closeApplicationDetails();" class="btn" style="padding: 0.875rem; background: rgba(239,68,68,0.3); border: 2px solid rgba(239,68,68,0.5); color: #F87171; font-weight: 600; flex: 1;">
                        ‚úó Reject
                    </button>
                    <button onclick="resetToPending('${app.id}'); closeApplicationDetails();" class="btn" style="padding: 0.875rem; background: rgba(156,150,119,0.3); border: 2px solid rgba(156,150,119,0.5); color: #9C9677; font-weight: 600; flex: 1;">
                        ‚Ü∫ Reset to Pending
                    </button>
                `;
            } else {
                // Rejected status
                actionButtonsHtml = `
                    <button onclick="approveApplication('${app.id}'); closeApplicationDetails();" class="btn" style="padding: 0.875rem; background: rgba(34,197,94,0.3); border: 2px solid rgba(34,197,94,0.5); color: #4ade80; font-weight: 600; flex: 1;">
                        ‚úì Approve
                    </button>
                    <button onclick="resetToPending('${app.id}'); closeApplicationDetails();" class="btn" style="padding: 0.875rem; background: rgba(156,150,119,0.3); border: 2px solid rgba(156,150,119,0.5); color: #9C9677; font-weight: 600; flex: 1;">
                        ‚Ü∫ Reset to Pending
                    </button>
                `;
            }

            content.innerHTML = `
                <div style="display: grid; gap: 1.5rem;">
                    <!-- Header -->
                    <div style="display: flex; align-items: center; gap: 1rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(246,204,104,0.2); flex-wrap: wrap;">
                        ${app.userPhoto 
                            ? `<img src="${app.userPhoto}" style="width: 70px; height: 70px; border-radius: 14px; object-fit: cover; border: 3px solid rgba(246,204,104,0.4);">` 
                            : `<div style="width: 70px; height: 70px; border-radius: 14px; background: linear-gradient(135deg, #9C9677, #f6cc68); display: flex; align-items: center; justify-content: center; font-size: 1.75rem; font-weight: 700; color: #010000;">${(safeString(app.userName) || safeString(app.name) || 'U').charAt(0).toUpperCase()}</div>`
                        }
                        <div style="flex: 1;">
                            <h3 style="margin: 0; font-size: 1.4rem; color: #fff;">${safeString(app.userName) || safeString(app.name) || '‚Äî'}</h3>
                            <p style="margin: 0.25rem 0 0; color: rgba(255,255,255,0.6);">‚úâÔ∏è ${safeString(app.userEmail) || safeString(app.email) || '‚Äî'}</p>
                            <p style="margin: 0.25rem 0 0; color: rgba(255,255,255,0.5);">üì± ${safeString(app.mobile) || '‚Äî'}</p>
                        </div>
                        <span class="status-badge status-${status.toLowerCase()}">${status}</span>
                    </div>

                    <!-- Details Grid -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 1rem;">
                        <div style="background: rgba(8,4,4,0.5); padding: 1rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                            <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">DOB</div>
                            <div style="margin-top: 0.25rem; color: #fff; font-weight: 600;">${safeString(app.dob) || '‚Äî'}</div>
                        </div>
                        <div style="background: rgba(8,4,4,0.5); padding: 1rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                            <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">Age</div>
                            <div style="margin-top: 0.25rem; color: #fff; font-weight: 600;">${safeString(app.age)} years</div>
                        </div>
                        <div style="background: rgba(8,4,4,0.5); padding: 1rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                            <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">Category</div>
                            <div style="margin-top: 0.25rem; color: #fff; font-weight: 600;">${safeString(app.ageCategory) || '‚Äî'}</div>
                        </div>
                        <div style="background: rgba(8,4,4,0.5); padding: 1rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                            <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">Payment</div>
                            <div style="margin-top: 0.25rem; color: #4ade80; font-weight: 600;">AED ${app.paymentAmount || 55} ‚úì</div>
                        </div>
                    </div>

                    <!-- Talent -->
                    <div style="background: rgba(8,4,4,0.5); padding: 1.25rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                        <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">üé≠ Talent Category</div>
                        <div style="margin-top: 0.5rem; color: #fff; font-size: 1.1rem; font-weight: 600;">${safeString(app.talentCategory) || '‚Äî'}</div>
                        ${safeString(app.talentSubCategory) ? `<div style="color: rgba(255,255,255,0.6);">‚Ü≥ ${safeString(app.talentSubCategory)}</div>` : ''}
                    </div>

                    <!-- Description -->
                    <div style="background: rgba(8,4,4,0.5); padding: 1.25rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                        <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">üìù Description</div>
                        <div style="margin-top: 0.5rem; color: #fff; line-height: 1.7; max-height: 150px; overflow-y: auto; white-space: pre-wrap;">${safeString(app.talent) || '‚Äî'}</div>
                    </div>

                    <!-- Performance Link -->
                    ${app.performanceLink ? `
                        <div style="background: rgba(8,4,4,0.5); padding: 1rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                            <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">üé¨ Performance Link</div>
                            <a href="${app.performanceLink}" target="_blank" style="color: #f6cc68; text-decoration: none; font-size: 0.9rem;">View Performance ‚Üí</a>
                        </div>
                    ` : ''}

                    <!-- Payment ID -->
                    <div style="background: rgba(8,4,4,0.5); padding: 1rem; border-radius: 10px; border: 1px solid rgba(246,204,104,0.15);">
                        <div style="font-size: 0.7rem; color: #f6cc68; text-transform: uppercase;">üí≥ Payment ID</div>
                        <div style="margin-top: 0.25rem; color: #fff; font-family: monospace;">${safeString(app.paymentId) || '‚Äî'}</div>
                    </div>

                    <!-- Files -->
                    <div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                            <span style="font-size: 0.9rem; color: #f6cc68; text-transform: uppercase; font-weight: 600;">üìÅ Files</span>
                            <span style="background: #f6cc68; color: #010000; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.75rem; font-weight: 700;">${driveUrls.length}</span>
                        </div>
                        ${filesHtml}
                    </div>

                    <!-- Submitted -->
                    <div style="text-align: center; padding-top: 1rem; border-top: 1px solid rgba(246,204,104,0.2); color: rgba(255,255,255,0.5);">
                        üìÖ Submitted: ${safeString(app.submittedAt) || '‚Äî'}
                    </div>

                    <!-- ACTION BUTTONS - Approve/Reject -->
                    <div style="display: flex; gap: 0.75rem; padding-top: 1rem; border-top: 2px solid rgba(246,204,104,0.3);">
                        ${actionButtonsHtml}
                    </div>
                </div>
            `;

            document.getElementById('applicationDetailsModal')?.classList.add('active');
        }

        function closeApplicationDetails() {
            document.getElementById('applicationDetailsModal')?.classList.remove('active');
            currentViewingApp = null;
        }

        // ==================== RECEIPT ====================
        function generateReceipt() {
            if (!pendingApplication) return showNotification('error', 'No application data!');

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const app = pendingApplication;
            
            // Header
            doc.setFillColor(246, 204, 104);
            doc.rect(0, 0, 210, 50, 'F');
            doc.setFillColor(1, 0, 0);
            doc.rect(0, 46, 210, 4, 'F');
            
            doc.setFontSize(28);
            doc.setTextColor(1, 0, 0);
            doc.setFont('helvetica', 'bold');
            doc.text('GODSPEED', 105, 22, { align: 'center' });
            doc.setFontSize(12);
            doc.text('ARABIAN TALENT LEAGUE', 105, 35, { align: 'center' });
            
            let y = 65;
            doc.setFontSize(16);
            doc.text('Payment Receipt', 14, y);
            doc.setFontSize(9);
            doc.setTextColor(100, 100, 100);
            doc.text('#' + app.paymentId, 196, y, { align: 'right' });
            
            y += 10;
            doc.setDrawColor(246, 204, 104);
            doc.line(14, y, 196, y);
            y += 10;
            
            doc.setFontSize(10);
            doc.setTextColor(60, 60, 60);
            
            const details = [
                ['Name', app.userName || app.name],
                ['Email', app.userEmail || app.email],
                ['Mobile', app.mobile],
                ['Age', `${app.age} years (${app.ageCategory})`],
                ['Category', app.talentCategory],
                ['Amount', `AED ${app.paymentAmount}`],
                ['Status', 'PAID ‚úì'],
                ['Date', app.submittedAt]
            ];
            
            details.forEach(([label, value]) => {
                doc.setFont('helvetica', 'bold');
                doc.text(label + ':', 14, y);
                doc.setFont('helvetica', 'normal');
                doc.text(String(value || '‚Äî'), 55, y);
                y += 7;
            });
            
            if (app.driveUrls?.length) {
                y += 5;
                doc.setFont('helvetica', 'bold');
                doc.text('Files:', 14, y);
                y += 6;
                doc.setFont('helvetica', 'normal');
                app.driveUrls.forEach((_, i) => {
                    doc.text('‚Ä¢ ' + (app.fileNames?.[i] || `File ${i + 1}`), 14, y);
                    y += 5;
                });
            }
            
            y += 10;
            doc.setFillColor(246, 204, 104);
            doc.roundedRect(14, y, 182, 20, 3, 3, 'F');
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(1, 0, 0);
            doc.text('Status: PENDING REVIEW', 105, y + 12, { align: 'center' });
            
            doc.setFontSize(8);
            doc.setTextColor(120, 120, 120);
            doc.text('Thank you for applying to Arabian Talent League!', 105, 280, { align: 'center' });

            doc.save(`ATL_Receipt_${app.paymentId}.pdf`);
            showNotification('success', 'Receipt downloaded!');
        }

        // ==================== NOTIFICATIONS ====================
        function showNotification(type, message) {
            document.querySelector('.notification')?.remove();

            const colors = {
                success: 'linear-gradient(135deg, rgba(34,197,94,0.95), rgba(22,163,74,0.95))',
                error: 'linear-gradient(135deg, rgba(239,68,68,0.95), rgba(220,38,38,0.95))',
                warning: 'linear-gradient(135deg, rgba(246,204,104,0.95), rgba(234,179,8,0.95))',
                info: 'linear-gradient(135deg, rgba(59,130,246,0.95), rgba(37,99,235,0.95))'
            };
            
            const icons = { success: '‚úì', error: '‚úó', warning: '‚ö†', info: '‚Ñπ' };
            const textColor = type === 'warning' ? '#010000' : '#fff';

            const el = document.createElement('div');
            el.className = 'notification';
            el.style.cssText = `
                position: fixed; top: 100px; right: 20px; background: ${colors[type]};
                color: ${textColor}; padding: 1rem 1.5rem; border-radius: 12px; font-weight: 500;
                z-index: 10000; display: flex; align-items: center; gap: 0.75rem;
                box-shadow: 0 10px 40px rgba(0,0,0,0.3); animation: slideIn 0.3s ease;
                max-width: 400px; font-family: 'Outfit', sans-serif;
            `;
            el.innerHTML = `<span style="font-size: 1.5rem;">${icons[type]}</span><span>${message}</span>`;
            
            document.body.appendChild(el);
            
            setTimeout(() => {
                el.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => el.remove(), 300);
            }, 4000);
        }

        // ==================== UTILITIES ====================
        function refreshApplications() {
            showNotification('info', 'Refreshing...');
            loadApplications();
        }

        function exportToCSV() {
            if (!sessionData.applications.length) {
                return showNotification('warning', 'No applications!');
            }

            const headers = ['ID', 'Name', 'Email', 'Mobile', 'Age', 'Age Category', 'Talent Category', 'Files', 'Payment', 'Status', 'Date'];
            const rows = sessionData.applications.map(a => [
                a.id, 
                a.name || a.userName, 
                a.email || a.userEmail, 
                a.mobile,
                a.age, 
                a.ageCategory,
                a.talentCategory, 
                `"${(a.talent || '').slice(0, 100).replace(/"/g, '""')}"`,
                (a.driveUrls || []).length, 
                a.paymentAmount, 
                a.status, 
                a.submittedAt
            ]);

            const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ATL_Export_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();

            showNotification('success', 'Exported!');
        }

        function closeFileViewer() {
            document.getElementById('fileViewerModal')?.classList.remove('active');
        }

        console.log('üöÄ Arabian Talent League - GODSPEED v3.1');
        console.log('üìã API:', GOOGLE_SHEETS_URL);
    </script>
</body>
</html>
